package duan;

import com.itextpdf.text.Document;
import com.itextpdf.text.Font;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.pdf.BaseFont;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import dao.QLSanPhamDAO;
import dao.QlChitietHDDAO;
import dao.QlHoaDonDAO;
import duan.entyti.QLHoaDon;
import duan.entyti.QLThongKe;
import duan.entyti.QlKhachHang;
import duan.entyti.QlLinhkien;
import duan.entyti.QlNhanVien;
import duan.entyti.QlSanPham;
import dao.QlThongKEDAO;
import duan.entyti.QLChitiethoadon;
import duan.uitil.PrintReport;
import duan.uitil.Xdate;
import duan.uitil.moneyFormat;
import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.List;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JDialog;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import javax.swing.text.Element;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.CellType;
import org.apache.poi.util.StringUtil;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFShape;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

/**
 *
 * @author Admin
 */
public class QL extends javax.swing.JFrame {

    QLSanPhamDAO spDAO = new QLSanPhamDAO();
    QlChitietHDDAO cthdDAO = new QlChitietHDDAO();
    QlHoaDonDAO hdDAO = new QlHoaDonDAO();
    QlThongKEDAO TKDAO = new QlThongKEDAO();
    int vitri = -1;
    int r = -1;
    String user = "sa";
    String pass = "123";
    String url = "jdbc:sqlserver://localhost:1433;databaseName=Duan1;encrypt=true;trustServerCertificate=true";
    List<QlSanPham> listSP = new ArrayList<QlSanPham>();
    List<QlKhachHang> listKh = new ArrayList<QlKhachHang>();
    List<QlLinhkien> listLK = new ArrayList<QlLinhkien>();
    List<QlNhanVien> listNV = new ArrayList<QlNhanVien>();
    List<QLThongKe> listTK = new ArrayList<QLThongKe>();
    List<QLHoaDon> listHD = new ArrayList<QLHoaDon>();

    List<QLChitiethoadon> listCTHD = new ArrayList<>();

    public QL() {
        initComponents();
        setLocationRelativeTo(null);
        dulieuaraySanPham();
        dulieulenbangSanPham();
        dulieuarayQLKhachhang();
        dulieulenbangQlKhachhang();
        DulieuArrayLK();
        dulieulenbangLK();
        DulieuArrayNV();
        dulieulenbangNV();
//        DulieuArrayTK();
        dulieulenbangTK();
        DulieuArrayHD();
        dulieulenbangHD();

//        fillTbSP();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        tabs = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        txtEmailNV = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        txtMaNV = new javax.swing.JTextField();
        txtTenNV = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        tbNhanVien = new javax.swing.JTable();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        txtDiaChiNV = new javax.swing.JTextField();
        txtNamSInhNV = new javax.swing.JTextField();
        txtSoDTNV = new javax.swing.JTextField();
        rdoNuNV = new javax.swing.JRadioButton();
        rdoNamNV = new javax.swing.JRadioButton();
        btntim1 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jButton12 = new javax.swing.JButton();
        jLabel11 = new javax.swing.JLabel();
        rdoNhanVienNV = new javax.swing.JRadioButton();
        rdoTruongPhongNV = new javax.swing.JRadioButton();
        txtTimKiem = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        txtmaSp = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        txtdate = new javax.swing.JTextField();
        txtmauxe = new javax.swing.JTextField();
        txtgiaxe = new javax.swing.JTextField();
        txttinhtrang = new javax.swing.JTextField();
        btntimQLSanPham = new javax.swing.JButton();
        txtmau = new javax.swing.JLabel();
        jLabel34 = new javax.swing.JLabel();
        btnThemQLSanPHam = new javax.swing.JButton();
        jLabel35 = new javax.swing.JLabel();
        jLabel36 = new javax.swing.JLabel();
        btnXoaQLSanPham = new javax.swing.JButton();
        jLabel37 = new javax.swing.JLabel();
        jScrollPane7 = new javax.swing.JScrollPane();
        tbsanpham = new javax.swing.JTable();
        txthangxe = new javax.swing.JTextField();
        txttenxe = new javax.swing.JTextField();
        btnCapNhatQLSanPHam = new javax.swing.JButton();
        txtodom = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jLabel38 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        txtSoluong = new javax.swing.JTextField();
        anh = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tbLinhKien = new javax.swing.JTable();
        txtMaLK = new javax.swing.JTextField();
        txtSoLuongLK = new javax.swing.JTextField();
        txtTenLK = new javax.swing.JTextField();
        lbAnhLK = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        txtNgayNhapLK = new javax.swing.JTextField();
        btntimLK = new javax.swing.JButton();
        btnthemLK = new javax.swing.JButton();
        jButton8 = new javax.swing.JButton();
        jButton13 = new javax.swing.JButton();
        Gia = new javax.swing.JLabel();
        txtGiaLK = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        txtTenKH = new javax.swing.JTextField();
        txtEmailKH = new javax.swing.JTextField();
        txtDiaChiKH = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tbkhachhang = new javax.swing.JTable();
        jLabel26 = new javax.swing.JLabel();
        txtMaKH = new javax.swing.JTextField();
        jButton9 = new javax.swing.JButton();
        jButton10 = new javax.swing.JButton();
        jButton14 = new javax.swing.JButton();
        txtSoDT = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        jScrollPane5 = new javax.swing.JScrollPane();
        tbThongKE = new javax.swing.JTable();
        txtTimKiemTK = new javax.swing.JTextField();
        jButton28 = new javax.swing.JButton();
        jLabel30 = new javax.swing.JLabel();
        jPanel6 = new javax.swing.JPanel();
        jLabel31 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        txtMaHD = new javax.swing.JTextField();
        txtNgayMuaHD = new javax.swing.JTextField();
        jScrollPane6 = new javax.swing.JScrollPane();
        tbhoaDon = new javax.swing.JTable();
        jLabel33 = new javax.swing.JLabel();
        jButton30 = new javax.swing.JButton();
        txtSoTienHD = new javax.swing.JTextField();
        txtGhichuHD = new javax.swing.JTextField();
        jLabel39 = new javax.swing.JLabel();
        txtMaNVHD = new javax.swing.JTextField();
        jLabel40 = new javax.swing.JLabel();
        txtMakHHD = new javax.swing.JTextField();
        jLabel41 = new javax.swing.JLabel();
        jLabel43 = new javax.swing.JLabel();
        txtSanPhamHD = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        txtEmailNV.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtEmailNVActionPerformed(evt);
            }
        });

        jLabel1.setText("MÃ NHÂN VIÊN");

        jLabel2.setText("TÊN NHÂN VIÊN");

        jLabel3.setText("Dịa Chỉ");

        jLabel4.setText("SDT");

        jLabel5.setText("NĂM SINH");

        txtMaNV.setEditable(false);
        txtMaNV.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtMaNVKeyReleased(evt);
            }
        });

        txtTenNV.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtTenNVKeyReleased(evt);
            }
        });

        tbNhanVien.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Mã NV", "Tên NV", "Email", "Địa CHỉ", "Giới tính", "Số DT", "Chức Vụ", "Năm Sinh"
            }
        ));
        tbNhanVien.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbNhanVienMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tbNhanVien);

        jLabel7.setText("Email");

        jLabel8.setText("GIỚI TÍNH");

        txtDiaChiNV.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtDiaChiNVActionPerformed(evt);
            }
        });

        txtNamSInhNV.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtNamSInhNVActionPerformed(evt);
            }
        });

        txtSoDTNV.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSoDTNVActionPerformed(evt);
            }
        });
        txtSoDTNV.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtSoDTNVKeyReleased(evt);
            }
        });

        buttonGroup2.add(rdoNuNV);
        rdoNuNV.setText("Nữ");

        buttonGroup2.add(rdoNamNV);
        rdoNamNV.setSelected(true);
        rdoNamNV.setText("Nam");

        btntim1.setText("TÌM");
        btntim1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btntim1ActionPerformed(evt);
            }
        });

        jButton5.setText("THÊM");
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });

        jButton6.setText("XÓA");
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });

        jButton12.setText("MỚI");
        jButton12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton12ActionPerformed(evt);
            }
        });

        jLabel11.setText("Chức Vụ");

        buttonGroup1.add(rdoNhanVienNV);
        rdoNhanVienNV.setSelected(true);
        rdoNhanVienNV.setText("Nhân Viên");

        buttonGroup1.add(rdoTruongPhongNV);
        rdoTruongPhongNV.setText("Trưởng Phòng");

        txtTimKiem.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtTimKiem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtTimKiemActionPerformed(evt);
            }
        });
        txtTimKiem.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtTimKiemKeyReleased(evt);
            }
        });

        jLabel13.setText("Tìm kiếm ");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel1)
                            .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 201, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(txtMaNV)
                            .addComponent(txtTenNV, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(75, 75, 75))
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addGroup(jPanel1Layout.createSequentialGroup()
                            .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(txtTimKiem, javax.swing.GroupLayout.PREFERRED_SIZE, 317, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(jPanel1Layout.createSequentialGroup()
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addGap(82, 82, 82)
                                    .addComponent(rdoNhanVienNV)
                                    .addGap(29, 29, 29)
                                    .addComponent(rdoTruongPhongNV))
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addGap(119, 119, 119)
                                    .addComponent(txtEmailNV, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE))))))
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(7, 7, 7)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, 64, Short.MAX_VALUE)
                            .addComponent(jLabel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                        .addGap(6, 6, 6)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                        .addComponent(rdoNamNV, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(rdoNuNV, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(txtSoDTNV, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtNamSInhNV, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtDiaChiNV, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(27, 27, 27)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jButton12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btntim1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton6, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(64, 64, 64))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel1)
                                .addComponent(txtMaNV, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel4)
                                .addComponent(txtSoDTNV, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(7, 7, 7)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel2)
                                    .addComponent(txtTenNV, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel5)))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(txtNamSInhNV, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(jLabel7)
                                .addGap(18, 18, 18))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                                .addComponent(txtEmailNV, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)))
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel11)
                                .addComponent(jLabel8)
                                .addComponent(rdoNamNV)
                                .addComponent(rdoNuNV))
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(rdoTruongPhongNV)
                                .addComponent(rdoNhanVienNV))))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(btntim1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jButton5)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jButton6)
                            .addComponent(txtDiaChiNV, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jButton12)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel13)
                    .addComponent(txtTimKiem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 385, Short.MAX_VALUE))
        );

        tabs.addTab("NHÂN VIÊN", jPanel1);

        jLabel9.setText("GIÁ XE");

        txtdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtdateActionPerformed(evt);
            }
        });

        txtmauxe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtmauxeActionPerformed(evt);
            }
        });

        txtgiaxe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtgiaxeActionPerformed(evt);
            }
        });

        txttinhtrang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txttinhtrangActionPerformed(evt);
            }
        });

        btntimQLSanPham.setText("TÌM");
        btntimQLSanPham.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btntimQLSanPhamActionPerformed(evt);
            }
        });

        txtmau.setText("MÀU");

        jLabel34.setText("HÃNG XE");

        btnThemQLSanPHam.setText("THÊM");
        btnThemQLSanPHam.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemQLSanPHamActionPerformed(evt);
            }
        });

        jLabel35.setText("TÌNH TRẠNG");

        jLabel36.setText("TÊN XE");

        btnXoaQLSanPham.setText("XÓA");
        btnXoaQLSanPham.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXoaQLSanPhamActionPerformed(evt);
            }
        });

        jLabel37.setText("Số KM");

        tbsanpham.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã Sản phẩm", "Tên xe", "Số KM", "Ngày bán", "Giá", "Màu", "Tình Trạng ", "Ảnh ", "Số Lượng ", "Nhà Cung Cấp"
            }
        ));
        tbsanpham.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbsanphamMouseClicked(evt);
            }
        });
        jScrollPane7.setViewportView(tbsanpham);

        txthangxe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txthangxeActionPerformed(evt);
            }
        });

        btnCapNhatQLSanPHam.setText("Update");
        btnCapNhatQLSanPHam.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCapNhatQLSanPHamActionPerformed(evt);
            }
        });

        jLabel6.setText("MÃ SP");

        jLabel38.setText("Ngày bán ");

        jLabel12.setText("Số Lượng");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(21, 21, 21)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel34, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel36, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel37))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtodom)
                            .addComponent(txttenxe)
                            .addComponent(txthangxe)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(16, 16, 16)
                                .addComponent(jLabel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(jLabel12)
                                .addGap(54, 54, 54)))
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtmaSp, javax.swing.GroupLayout.DEFAULT_SIZE, 260, Short.MAX_VALUE)
                            .addComponent(txtSoluong))))
                .addGap(132, 132, 132)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(txtmau, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel9, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jLabel38, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(39, 39, 39)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtmauxe)
                            .addComponent(txtdate)
                            .addComponent(txtgiaxe)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel35, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txttinhtrang, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addGap(69, 69, 69)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnCapNhatQLSanPHam, javax.swing.GroupLayout.DEFAULT_SIZE, 81, Short.MAX_VALUE)
                    .addComponent(btntimQLSanPham, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnThemQLSanPHam, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnXoaQLSanPham, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(73, 73, 73))
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(jScrollPane7, javax.swing.GroupLayout.DEFAULT_SIZE, 707, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(anh, javax.swing.GroupLayout.PREFERRED_SIZE, 273, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(7, 7, 7)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel34)
                                    .addComponent(txthangxe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel36)
                                    .addComponent(txttenxe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                .addGap(11, 11, 11)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel38)
                                    .addComponent(txtgiaxe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(16, 16, 16)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel9)
                                    .addComponent(txtdate, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel37)
                            .addComponent(txtodom, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtmau)
                            .addComponent(txtmauxe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txtmaSp, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel6))
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel35)
                                .addComponent(txttinhtrang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(btntimQLSanPham)
                        .addGap(18, 18, 18)
                        .addComponent(btnThemQLSanPHam)
                        .addGap(18, 18, 18)
                        .addComponent(btnXoaQLSanPham)
                        .addGap(11, 11, 11)
                        .addComponent(btnCapNhatQLSanPHam)))
                .addGap(12, 12, 12)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel12)
                    .addComponent(txtSoluong, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(25, 25, 25)
                        .addComponent(anh, javax.swing.GroupLayout.PREFERRED_SIZE, 261, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 261, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(0, 0, Short.MAX_VALUE))
        );

        tabs.addTab("SẢN PHẨM", jPanel2);

        tbLinhKien.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "MaLK", "Số luọng", "Ngày Nhập ", "Ảnh", "Giá", "TênLK"
            }
        ));
        tbLinhKien.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbLinhKienMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(tbLinhKien);

        txtSoLuongLK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSoLuongLKActionPerformed(evt);
            }
        });

        lbAnhLK.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lbAnhLKMouseClicked(evt);
            }
        });

        jLabel17.setText("MaLK");

        jLabel18.setText("Số lượng");

        jLabel19.setText("Tên LK");

        jLabel10.setText("Ngày nhập");

        btntimLK.setText("TÌM");
        btntimLK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btntimLKActionPerformed(evt);
            }
        });

        btnthemLK.setText("THÊM");
        btnthemLK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnthemLKActionPerformed(evt);
            }
        });

        jButton8.setText("XÓA");
        jButton8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton8ActionPerformed(evt);
            }
        });

        jButton13.setText("SỬA");
        jButton13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton13ActionPerformed(evt);
            }
        });

        Gia.setText("Giá");

        txtGiaLK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtGiaLKActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jLabel18, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtMaLK)
                    .addComponent(txtSoLuongLK, javax.swing.GroupLayout.DEFAULT_SIZE, 204, Short.MAX_VALUE)
                    .addComponent(txtNgayNhapLK))
                .addGap(39, 39, 39)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel19, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(Gia))
                .addGap(18, 18, 18)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtGiaLK, javax.swing.GroupLayout.DEFAULT_SIZE, 174, Short.MAX_VALUE)
                    .addComponent(txtTenLK, javax.swing.GroupLayout.DEFAULT_SIZE, 174, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 251, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jButton13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btntimLK, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnthemLK, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton8, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(86, 86, 86))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(lbAnhLK, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel3Layout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 603, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(377, Short.MAX_VALUE)))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel19)
                            .addComponent(txtTenLK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(27, 27, 27)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(Gia)
                            .addComponent(txtGiaLK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel17)
                            .addComponent(txtMaLK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtSoLuongLK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel18))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel10)
                            .addComponent(txtNgayNhapLK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(btntimLK)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnthemLK)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jButton8)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jButton13)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 97, Short.MAX_VALUE)
                .addComponent(lbAnhLK, javax.swing.GroupLayout.PREFERRED_SIZE, 309, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                    .addContainerGap(223, Short.MAX_VALUE)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 317, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap()))
        );

        tabs.addTab("LINH KIỆN", jPanel3);

        txtTenKH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtTenKHActionPerformed(evt);
            }
        });

        jLabel22.setText("MaKH");

        jLabel23.setText("TÊNKH");

        jLabel24.setText("SoDT");

        jLabel25.setText("Email");

        tbkhachhang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "MaKH", "TênKH", "SoDT", "Email", "Địa chỉ"
            }
        ));
        tbkhachhang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbkhachhangMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(tbkhachhang);

        jLabel26.setText("DiaChi");

        jButton9.setText("THÊM");
        jButton9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton9ActionPerformed(evt);
            }
        });

        jButton10.setText("XÓA");
        jButton10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton10ActionPerformed(evt);
            }
        });

        jButton14.setText("CẬP NHẬT");
        jButton14.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton14ActionPerformed(evt);
            }
        });

        txtSoDT.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSoDTActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel24, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel23))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtMaKH)
                    .addComponent(txtTenKH, javax.swing.GroupLayout.DEFAULT_SIZE, 204, Short.MAX_VALUE)
                    .addComponent(txtSoDT))
                .addGap(9, 9, 9)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel26, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel25, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(60, 60, 60)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtEmailKH, javax.swing.GroupLayout.DEFAULT_SIZE, 324, Short.MAX_VALUE)
                    .addComponent(txtDiaChiKH))
                .addGap(41, 41, 41)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jButton14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton10, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(101, 101, 101))
            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel4Layout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 980, Short.MAX_VALUE)))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel4Layout.createSequentialGroup()
                            .addGap(79, 79, 79)
                            .addComponent(jLabel24))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                            .addComponent(jButton9)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                            .addComponent(jButton10)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                            .addComponent(jButton14)))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel25)
                            .addComponent(txtEmailKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel26)
                            .addComponent(txtDiaChiKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel22)
                            .addComponent(txtMaKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtTenKH, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel23))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtSoDT, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(444, Short.MAX_VALUE))
            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                    .addContainerGap(206, Short.MAX_VALUE)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 334, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap()))
        );

        tabs.addTab("KHÁCH HÀNG", jPanel4);

        tbThongKE.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Tên Xe", "Năm ", "Giá", "Số lượng", "Tổng"
            }
        ));
        jScrollPane5.setViewportView(tbThongKE);

        txtTimKiemTK.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtTimKiemTKKeyReleased(evt);
            }
        });

        jButton28.setText("THỐNG KÊ");
        jButton28.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton28ActionPerformed(evt);
            }
        });

        jLabel30.setText("Năm");

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtTimKiemTK, javax.swing.GroupLayout.PREFERRED_SIZE, 409, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(42, 42, 42)
                .addComponent(jButton28)
                .addContainerGap(386, Short.MAX_VALUE))
            .addComponent(jScrollPane5)
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(31, 31, 31)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel30)
                    .addComponent(txtTimKiemTK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton28))
                .addGap(102, 102, 102)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 304, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(86, Short.MAX_VALUE))
        );

        tabs.addTab("THỐNG KÊ", jPanel5);

        jLabel31.setText("NgayMUa");

        jLabel32.setText("SoTien");

        txtNgayMuaHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtNgayMuaHDActionPerformed(evt);
            }
        });

        tbhoaDon.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null}
            },
            new String [] {
                "MaHD", "Ngay Mua", "Ghi chu", "MaNV", "MaKH", "San Pham", "So tien "
            }
        ));
        jScrollPane6.setViewportView(tbhoaDon);

        jLabel33.setText("MaHD");

        jButton30.setText("XUẤT HÓA ĐƠN");
        jButton30.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton30ActionPerformed(evt);
            }
        });

        jLabel39.setText("Gi chú");

        txtMaNVHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtMaNVHDActionPerformed(evt);
            }
        });

        jLabel40.setText("MaNV");

        txtMakHHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtMakHHDActionPerformed(evt);
            }
        });

        jLabel41.setText("MaKH");

        jLabel43.setText("SanPHam");

        txtSanPhamHD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSanPhamHDActionPerformed(evt);
            }
        });

        jButton1.setText("Thêm");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel31, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel33)
                    .addComponent(jLabel40, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(txtMaHD)
                            .addComponent(txtNgayMuaHD, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel6Layout.createSequentialGroup()
                                .addGap(26, 26, 26)
                                .addComponent(jLabel32, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(37, 37, 37))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel41, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel39, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel43, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(27, 27, 27))))
                    .addComponent(txtMaNVHD, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(txtSanPhamHD, javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtSoTienHD, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 142, Short.MAX_VALUE)
                    .addComponent(txtGhichuHD, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 142, Short.MAX_VALUE)
                    .addComponent(txtMakHHD, javax.swing.GroupLayout.Alignment.LEADING))
                .addGap(80, 80, 80)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jButton30, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(126, Short.MAX_VALUE))
            .addComponent(jScrollPane6)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel33)
                            .addComponent(txtMaHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtNgayMuaHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel31)
                            .addComponent(txtGhichuHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txtMaNVHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel40))
                            .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txtSanPhamHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel43)))
                        .addGap(28, 28, 28)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel41)
                            .addComponent(txtMakHHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel32)
                            .addComponent(txtSoTienHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jButton30))
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel6Layout.createSequentialGroup()
                                .addGap(18, 18, 18)
                                .addComponent(jLabel39))
                            .addGroup(jPanel6Layout.createSequentialGroup()
                                .addGap(9, 9, 9)
                                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel6Layout.createSequentialGroup()
                                .addGap(28, 28, 28)
                                .addComponent(jButton1)))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 108, Short.MAX_VALUE)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 280, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        tabs.addTab("GIỎ HÀNG", jPanel6);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabs)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(tabs, javax.swing.GroupLayout.Alignment.TRAILING)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        themHD();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void txtSanPhamHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSanPhamHDActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSanPhamHDActionPerformed

    private void txtMakHHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtMakHHDActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtMakHHDActionPerformed

    private void txtMaNVHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtMaNVHDActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtMaNVHDActionPerformed

    private void jButton30ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton30ActionPerformed
        // TODO add your handling code here:
//        InHoaDon();
inhoadonmoi();
    }//GEN-LAST:event_jButton30ActionPerformed

    private void txtNgayMuaHDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtNgayMuaHDActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtNgayMuaHDActionPerformed

    private void jButton28ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton28ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton28ActionPerformed

    private void txtTimKiemTKKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTimKiemTKKeyReleased
        // TODO add your handling code here:
        //        TimKiemTK();
        dulieulenbangTK();
    }//GEN-LAST:event_txtTimKiemTKKeyReleased

    private void txtSoDTActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSoDTActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSoDTActionPerformed

    private void jButton14ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton14ActionPerformed
        // TODO add your handling code here:
        capnhatQlKhachhang();
    }//GEN-LAST:event_jButton14ActionPerformed

    private void jButton10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton10ActionPerformed
        // TODO add your handling code here:
        xoaQLKhachhang();
    }//GEN-LAST:event_jButton10ActionPerformed

    private void jButton9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton9ActionPerformed
        // TODO add your handling code here:
        ThemQlKhachhang();
    }//GEN-LAST:event_jButton9ActionPerformed

    private void tbkhachhangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbkhachhangMouseClicked
        // TODO add your handling code here:
        vitri = tbkhachhang.getSelectedRow();
        LoadDataConTrolKhachhang(vitri);
    }//GEN-LAST:event_tbkhachhangMouseClicked

    private void txtTenKHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtTenKHActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtTenKHActionPerformed

    private void txtGiaLKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtGiaLKActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtGiaLKActionPerformed

    private void jButton13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton13ActionPerformed
        // TODO add your handling code here:
        capnhatLK();
    }//GEN-LAST:event_jButton13ActionPerformed

    private void jButton8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton8ActionPerformed
        // TODO add your handling code here:
        xoaLK();
    }//GEN-LAST:event_jButton8ActionPerformed

    private void btnthemLKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnthemLKActionPerformed
        // TODO add your handling code here:
        themLK();
    }//GEN-LAST:event_btnthemLKActionPerformed

    private void btntimLKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btntimLKActionPerformed
        // TODO add your handling code here:
        timLK();
        //timLK();
    }//GEN-LAST:event_btntimLKActionPerformed

    private void lbAnhLKMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbAnhLKMouseClicked
        // TODO add your handling code here:
        anhLK();
    }//GEN-LAST:event_lbAnhLKMouseClicked

    private void txtSoLuongLKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSoLuongLKActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSoLuongLKActionPerformed

    private void tbLinhKienMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbLinhKienMouseClicked
        // TODO add your handling code here:
        vitri = tbLinhKien.getSelectedRow();
        LoadDataConTrolLK(vitri);
    }//GEN-LAST:event_tbLinhKienMouseClicked

    private void btnCapNhatQLSanPHamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCapNhatQLSanPHamActionPerformed
        // TODO add your handling code here:
        capnhatSanPham();
    }//GEN-LAST:event_btnCapNhatQLSanPHamActionPerformed

    private void txthangxeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txthangxeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txthangxeActionPerformed

    private void tbsanphamMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbsanphamMouseClicked
        // TODO add your handling code here:
        vitri = tbsanpham.getSelectedRow();
        LoadDataConTrolSanPham(vitri);

    }//GEN-LAST:event_tbsanphamMouseClicked

    private void btnXoaQLSanPhamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXoaQLSanPhamActionPerformed
        // TODO add your handling code here:
        xoa();
    }//GEN-LAST:event_btnXoaQLSanPhamActionPerformed

    private void btnThemQLSanPHamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemQLSanPHamActionPerformed
        // TODO add your handling code here:
        saveSanPham();
    }//GEN-LAST:event_btnThemQLSanPHamActionPerformed

    private void btntimQLSanPhamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btntimQLSanPhamActionPerformed
        // TODO add your handling code here:
        timkiemSanPham1();
    }//GEN-LAST:event_btntimQLSanPhamActionPerformed

    private void txttinhtrangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txttinhtrangActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txttinhtrangActionPerformed

    private void txtgiaxeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtgiaxeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtgiaxeActionPerformed

    private void txtmauxeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtmauxeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtmauxeActionPerformed

    private void txtdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtdateActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtdateActionPerformed

    private void txtTimKiemKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTimKiemKeyReleased
        // TODO add your handling code here:
        timkiemNVlo();
    }//GEN-LAST:event_txtTimKiemKeyReleased

    private void txtTimKiemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtTimKiemActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtTimKiemActionPerformed

    private void jButton12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton12ActionPerformed
        // TODO add your handling code here:
        //        moiNV();
    }//GEN-LAST:event_jButton12ActionPerformed

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
        // TODO add your handling code here:
        xoaNV();
    }//GEN-LAST:event_jButton6ActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        // TODO add your handling code here:
        ThemNV();
    }//GEN-LAST:event_jButton5ActionPerformed

    private void btntim1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btntim1ActionPerformed
        // TODO add your handling code here:
        timNV();
    }//GEN-LAST:event_btntim1ActionPerformed

    private void txtSoDTNVKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSoDTNVKeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSoDTNVKeyReleased

    private void txtSoDTNVActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSoDTNVActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSoDTNVActionPerformed

    private void txtNamSInhNVActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtNamSInhNVActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtNamSInhNVActionPerformed

    private void txtDiaChiNVActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtDiaChiNVActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtDiaChiNVActionPerformed

    private void tbNhanVienMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbNhanVienMouseClicked
        //         TODO add your handling code here:
        int r = tbNhanVien.getSelectedRow();
        if (r < 0) {
            return;
        }
        txtMaNV.setText(tbNhanVien.getValueAt(r, 0).toString());
        txtTenNV.setText(tbNhanVien.getValueAt(r, 1).toString());

        txtEmailNV.setText(tbNhanVien.getValueAt(r, 2).toString());
        txtDiaChiNV.setText(tbNhanVien.getValueAt(r, 3).toString());
        Boolean gt = Boolean.parseBoolean(tbNhanVien.getValueAt(r, 4).toString());
        if (gt) {//.equals("Nam")
            rdoNamNV.setSelected(true);
        } else {
            rdoNuNV.setSelected(true);
        }
        txtSoDTNV.setText(tbNhanVien.getValueAt(r, 5).toString());
        Boolean CHucVu = Boolean.parseBoolean(tbNhanVien.getValueAt(r, 6).toString());
        if (CHucVu) {//.equals("true")
            rdoTruongPhongNV.setSelected(true);
        } else {
            rdoNhanVienNV.setSelected(true);
        }
        txtNamSInhNV.setText(tbNhanVien.getValueAt(r, 7).toString());

    }//GEN-LAST:event_tbNhanVienMouseClicked

    private void txtTenNVKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTenNVKeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_txtTenNVKeyReleased

    private void txtMaNVKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtMaNVKeyReleased
        // TODO add your handling code here:

    }//GEN-LAST:event_txtMaNVKeyReleased

    private void txtEmailNVActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtEmailNVActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtEmailNVActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(QL.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(QL.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(QL.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(QL.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new QL().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel Gia;
    private javax.swing.JLabel anh;
    private javax.swing.JButton btnCapNhatQLSanPHam;
    private javax.swing.JButton btnThemQLSanPHam;
    private javax.swing.JButton btnXoaQLSanPham;
    private javax.swing.JButton btnthemLK;
    private javax.swing.JButton btntim1;
    private javax.swing.JButton btntimLK;
    private javax.swing.JButton btntimQLSanPham;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton10;
    private javax.swing.JButton jButton12;
    private javax.swing.JButton jButton13;
    private javax.swing.JButton jButton14;
    private javax.swing.JButton jButton28;
    private javax.swing.JButton jButton30;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JButton jButton8;
    private javax.swing.JButton jButton9;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel43;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JLabel lbAnhLK;
    private javax.swing.JRadioButton rdoNamNV;
    private javax.swing.JRadioButton rdoNhanVienNV;
    private javax.swing.JRadioButton rdoNuNV;
    private javax.swing.JRadioButton rdoTruongPhongNV;
    private javax.swing.JTabbedPane tabs;
    private javax.swing.JTable tbLinhKien;
    private javax.swing.JTable tbNhanVien;
    private javax.swing.JTable tbThongKE;
    private javax.swing.JTable tbhoaDon;
    private javax.swing.JTable tbkhachhang;
    private javax.swing.JTable tbsanpham;
    private javax.swing.JTextField txtDiaChiKH;
    private javax.swing.JTextField txtDiaChiNV;
    private javax.swing.JTextField txtEmailKH;
    private javax.swing.JTextField txtEmailNV;
    private javax.swing.JTextField txtGhichuHD;
    private javax.swing.JTextField txtGiaLK;
    private javax.swing.JTextField txtMaHD;
    private javax.swing.JTextField txtMaKH;
    private javax.swing.JTextField txtMaLK;
    private javax.swing.JTextField txtMaNV;
    private javax.swing.JTextField txtMaNVHD;
    private javax.swing.JTextField txtMakHHD;
    private javax.swing.JTextField txtNamSInhNV;
    private javax.swing.JTextField txtNgayMuaHD;
    private javax.swing.JTextField txtNgayNhapLK;
    private javax.swing.JTextField txtSanPhamHD;
    private javax.swing.JTextField txtSoDT;
    private javax.swing.JTextField txtSoDTNV;
    private javax.swing.JTextField txtSoLuongLK;
    private javax.swing.JTextField txtSoTienHD;
    private javax.swing.JTextField txtSoluong;
    private javax.swing.JTextField txtTenKH;
    private javax.swing.JTextField txtTenLK;
    private javax.swing.JTextField txtTenNV;
    private javax.swing.JTextField txtTimKiem;
    private javax.swing.JTextField txtTimKiemTK;
    private javax.swing.JTextField txtdate;
    private javax.swing.JTextField txtgiaxe;
    private javax.swing.JTextField txthangxe;
    private javax.swing.JTextField txtmaSp;
    private javax.swing.JLabel txtmau;
    private javax.swing.JTextField txtmauxe;
    private javax.swing.JTextField txtodom;
    private javax.swing.JTextField txttenxe;
    private javax.swing.JTextField txttinhtrang;
    // End of variables declaration//GEN-END:variables
public void dulieuaraySanPham() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);

            Statement st = cone.createStatement();
            String sql = "Select * from SanPhamDaBan";
            ResultSet rs = (ResultSet) st.executeQuery(sql);
            listSP.clear();
            while (rs.next()) {
                String maSP = rs.getString("MaSP");
                String tenXe = rs.getString("TenXe");
                String SoKM = rs.getString("SoKM");
                String NgayBan = rs.getString("NgayBan");
                Double Gia = rs.getDouble("Gia");
                String Mau = rs.getString("Mau");
                String TinhTrang = rs.getString("TinhTrang");
                String Anh = rs.getString("Anh");

                String SoLuong = rs.getString("SoLuong");
                String MaNCC = rs.getString("MaNCC");

                QlSanPham SP = new QlSanPham(maSP, tenXe, SoKM, NgayBan, Gia, Mau, TinhTrang, Anh, SoLuong, MaNCC);
                listSP.add(SP);
            }
            cone.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void dulieulenbangSanPham() {
        DefaultTableModel model = (DefaultTableModel) tbsanpham.getModel();
        model.setRowCount(0);
        for (QlSanPham sv : listSP) {
            Object row[] = new Object[]{
                sv.getMaSP(),
                sv.getTenXe(),
                sv.getSoKM(),
                sv.getNgayBan(),
                sv.getGia(),
                sv.getMau(),
                sv.getTinhTrang(),
                sv.getAnh(),
                sv.getSoLuong(),
                sv.getMaNCC()};
            model.addRow(row);
        }
        tbsanpham.setModel(model);
    }
    // test 

    public void timkiemSanPham1() {
        
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            //String Url = "jdbc:sqlserver://localhost:1433;databaseName=QLLK";
            Connection con = DriverManager.getConnection(url, user, pass);
            PreparedStatement ps = con.prepareStatement("select SanPhamDaBan.MaSP,TenXe,SoKM,NgayBan,Gia,Mau,TinhTrang,Anh,SoLuong,MaNCC from SanPhamDaBan where SanPhamDaBan.MaSP = ? ");
            // truyền tham số
            ps.setString(1, txtmaSp.getText());
            ResultSet rs = ps.executeQuery();

            // clear danh sách list 
            listSP.clear();
            while (rs.next()) {
                // tạo đối tượng BangDiem
                QlSanPham gra = new QlSanPham();
                gra.setMaSP(rs.getString("MaSP"));

                gra.setTenXe(rs.getString("TenXe"));
                gra.setSoKM(rs.getString("SoKM"));
                gra.setNgayBan(rs.getString("NgayBan"));
                gra.setGia(rs.getDouble("Gia"));
                gra.setMau(rs.getString("Mau"));
                gra.setTinhTrang(rs.getString("TinhTrang"));
                gra.setAnh(rs.getString("Anh"));
                gra.setSoLuong(rs.getString("SoLuong"));
                gra.setMaNCC(rs.getString("MaNCC"));

                listSP.add(gra);
            }
            // hiển thị danh sách lên tbl
            DefaultTableModel model = (DefaultTableModel) tbsanpham.getModel();
            model.setRowCount(0);
            for (QlSanPham gr : listSP) {
                Object[] row = new Object[]{gr.getMaSP(), gr.getTenXe(), gr.getSoKM(), gr.getNgayBan(), gr.getGia(), gr.getMau(), gr.getTinhTrang(), gr.getAnh(), gr.getSoLuong(), gr.getMaNCC()};
                model.addRow(row);
                System.out.println(row);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void saveSanPham() {
       if (txtmaSp.getText().equals("")) {
            JOptionPane.showMessageDialog(this, "Không được để trống mã sản phẩm");
//            txtMaNV.requestFocus();
            return;
        }

        try {
            
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");

            Connection con = DriverManager.getConnection(url, user, pass);

            // truyền giá trị cho tham số
            PreparedStatement ps = con.prepareStatement("insert into SanPhamDaBan values(?,?,?,?,?,?,?,?,?,?)");
            ps.setString(1, txtmaSp.getText());
            ps.setString(2, (txttenxe.getText()));
            ps.setString(3, (txtodom.getText()));
            ps.setString(4, (txtdate.getText()));
            ps.setString(5, (txtgiaxe.getText()));
            ps.setString(6, (txtmauxe.getText()));
            ps.setString(7, (txttinhtrang.getText()));
            ps.setString(8, (anh.getText()));
            ps.setString(9, (txtSoluong.getText()));
            ps.setString(10, (txthangxe.getText()));
            // thi hành
            int kq = ps.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Thêm Thành Công");
            }
            // đóng kết nối lại
            dulieulenbangSanPham();
            ps.close();
            con.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void LoadDataConTrolSanPham(int vitri) {
        txtmaSp.setText(listSP.get(vitri).getMaSP());

        txttenxe.setText(String.valueOf(listSP.get(vitri).getTenXe()));
        txtodom.setText(String.valueOf(listSP.get(vitri).getSoKM()));
        txtdate.setText(String.valueOf(listSP.get(vitri).getNgayBan()));
        txtgiaxe.setText(String.valueOf(listSP.get(vitri).getGia()));
        txtmauxe.setText(String.valueOf(listSP.get(vitri).getMau()));
        txttinhtrang.setText(String.valueOf(listSP.get(vitri).getTinhTrang()));
//        anh.setText(String.valueOf(list.get(vitri).getAnh()));
        anh.setIcon(new ImageIcon(String.valueOf(listSP.get(vitri).getAnh())));// check chưa gắn link database
        txtSoluong.setText(String.valueOf(listSP.get(vitri).getSoLuong()));
        txthangxe.setText(String.valueOf(listSP.get(vitri).getMaNCC()));
    }

    public void xoa() {
        DefaultTableModel model = (DefaultTableModel) tbsanpham.getModel();
        model.removeRow(vitri);
        JOptionPane.showMessageDialog(this, "Xóa thành công");
    }

    public void capnhatSanPham() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);

            // truyền giá trị cho tham số
            PreparedStatement ps = con.prepareStatement("update SanPhamDaBan set TenXe=?,SoKM=?,NgayBan=?,Gia=?,Mau=?,TinhTrang=?,Anh=?,SoLuong=?,MaNCC=? where SanPhamDaBan.MaSP=?");
            ps.setString(10, txtmaSp.getText());

            ps.setString(1, (txttenxe.getText()));
            ps.setString(2, (txtodom.getText()));
            ps.setString(3, (txtdate.getText()));
            ps.setString(4, (txtgiaxe.getText()));
            ps.setString(5, (txtmauxe.getText()));
            ps.setString(6, (txttinhtrang.getText()));
            ps.setString(7, (anh.getText()));
            ps.setString(8, (txtSoluong.getText()));
            ps.setString(9, (txthangxe.getText()));

            // thi hành
//            int kq = 
            ps.executeUpdate();
//            if (kq == 1) {
            JOptionPane.showMessageDialog(this, "Cập nhật thành công");
//            }
            // đóng kết nối lại
            ps.close();
            con.close();
            dulieuaraySanPham();
            dulieulenbangSanPham();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void anhQLSanPham() {
        try {
            // TODO add your handling code here:

            JFileChooser jfc = new JFileChooser("D:\\nhạpmonkithuatphanmem\\anhxe");

            jfc.showOpenDialog(null);
            File file = jfc.getSelectedFile();
            Image img = ImageIO.read(file);
            anh.setText("");
            int W = anh.getWidth();
            int h = anh.getHeight();
            anh.setIcon(new ImageIcon(img.getScaledInstance(W, h, 0)));
        } catch (IOException ex) {
            System.out.println("Error:" + ex.toString());
        }
    }

    public void anhmoi() {
        JFileChooser filecho = new JFileChooser();
        filecho.setFileSelectionMode(filecho.FILES_ONLY);
        int retu = filecho.showOpenDialog(this);
        if (retu == filecho.APPROVE_OPTION) {
            File file = filecho.getSelectedFile();
            String pat = file.getAbsolutePath();
            BufferedImage b;
            try {
                b = ImageIO.read(file);
                anh.setIcon(new ImageIcon(b));
            } catch (Exception e) {
            }
        }
    }
// khách hàng 

    public void dulieuarayQLKhachhang() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);

            Statement st = cone.createStatement();
            String sql = "Select * from KhachHang";
            ResultSet rs = (ResultSet) st.executeQuery(sql);
            listKh.clear();
            while (rs.next()) {
                String maKH = rs.getString("MaKH");
                String tenKH = rs.getString("TenKH");
                String SoDT = rs.getString("SoDT");
                String Email = rs.getString("Email");
                String DiaChi = rs.getString("DiaChi");

                QlKhachHang SP = new QlKhachHang(maKH, tenKH, SoDT, Email, DiaChi);
                listKh.add(SP);
            }
            cone.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void dulieulenbangQlKhachhang() {
        DefaultTableModel model = (DefaultTableModel) tbkhachhang.getModel();
        model.setRowCount(0);
        for (QlKhachHang sv : listKh) {
            Object row[] = new Object[]{sv.getMaKH(), sv.getTenKH(), sv.getSoDT(), sv.getEmail(), sv.getDiaChi()};
            model.addRow(row);
        }
        tbkhachhang.setModel(model);
    }

    public void LoadDataConTrolKhachhang(int vitri) {
        txtMaKH.setText(listKh.get(vitri).getMaKH());

        txtTenKH.setText(String.valueOf(listKh.get(vitri).getTenKH()));
//        txtSoDT.setText(String.valueOf((char) listKh.get(vitri).getSoDT())); // nghiên cứu lại 
        txtSoDT.setText(String.valueOf(listKh.get(vitri).getSoDT()));

        txtEmailKH.setText(String.valueOf(listKh.get(vitri).getEmail()));
        txtDiaChiKH.setText(String.valueOf(listKh.get(vitri).getDiaChi()));

    }

    public void ThemQlKhachhang() {
        String kt = txtMaKH.getText().trim();
        for (QlKhachHang existingNV : listKh) {
            if (String.valueOf(existingNV.getMaKH()).equals(kt)) {
//                JOptionPane.showMessageDialog(this, "Mã nhân viên đã tồn tại. Vui lòng chọn mã khác.", "Thông báo", JOptionPane.ERROR_MESSAGE);
                JOptionPane.showMessageDialog(this,"Mã nhân viên đã tồn tại");
                    return;
            }
        }
        if (txtMaKH.getText().equals("")) {
            JOptionPane.showMessageDialog(this, "Không được để chống mã");
//            txtMaNV.requestFocus();
            return;
        }
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);
            String sql = "insert into KhachHang values(?,?,?,?,?)";
            PreparedStatement st = cone.prepareStatement(sql);
            st.setString(1, txtMaKH.getText());
            st.setString(2, txtTenKH.getText());

//            st.setInt(3, txtSoDT.getText());
            st.setString(3, txtSoDT.getText());

            st.setString(4, txtEmailKH.getText());
            st.setString(5, txtDiaChiKH.getText());
            st.executeUpdate();
            JOptionPane.showMessageDialog(this, "Seve thanh cong");
//            loadDatatoAray();
            dulieuarayQLKhachhang();
            dulieulenbangQlKhachhang();
            cone.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void xoaQLKhachhang() {

        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection connect = null;
            connect = DriverManager.getConnection(url, user, pass);
            String sql = "delete from KhachHang where MaKh = ?";
            PreparedStatement st = connect.prepareStatement(sql);
            st.setString(1, txtMaKH.getText());

            //thi hành
            int kq = st.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Xóa thành công");
            }
            dulieuarayQLKhachhang();
            dulieulenbangQlKhachhang();
            st.close();
            connect.close();

        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    void capnhatQlKhachhang() {

        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);

            // truyền giá trị cho tham số
            PreparedStatement ps = con.prepareStatement("update KhachHang set TenKH=?,SoDT=?,Email=?,DiaChi=? where KhachHang.MaKH=?");
            ps.setString(5, txtMaKH.getText());
            ps.setString(1, (txtTenKH.getText()));
            ps.setString(2, txtSoDT.getText());
            ps.setString(3, (txtEmailKH.getText()));
            ps.setString(4, (txtDiaChiKH.getText()));

            ps.executeUpdate();
//            if (kq == 1) {
            JOptionPane.showMessageDialog(this, "Cập nhật thành Công");
//            }
            // đóng kết nối lại
            ps.close();
            con.close();

            dulieulenbangQlKhachhang();
            dulieuarayQLKhachhang();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    // linh kiện 
    void DulieuArrayLK() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);

            Statement st = cone.createStatement();
            String sql = "Select * from LinhKien";
            ResultSet rs = (ResultSet) st.executeQuery(sql);
            listLK.clear();
            while (rs.next()) {
                String maLK = rs.getString("MaLK");
                Integer SoLuongLK = rs.getInt("SoLuong");
                String NgayNhapLK = rs.getString("NgayNhap");
                String AnhLK = rs.getString("Anh");
                String GiaLK = rs.getString("Gia");
                String TenLK = rs.getString("TenLK");
                QlLinhkien LK = new QlLinhkien(maLK, SoLuongLK, NgayNhapLK, AnhLK, GiaLK, TenLK);
                listLK.add(LK);
            }
            cone.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void dulieulenbangLK() {
        DefaultTableModel model = (DefaultTableModel) tbLinhKien.getModel();
        model.setRowCount(0);
        for (QlLinhkien sv : listLK) {
            Object row[] = new Object[]{sv.getMaLK(), sv.getSoLuongLK(), sv.getNgayNhapLK(), sv.getAnhLK(), sv.getGiaLK(), sv.getTenLK()};
            model.addRow(row);
        }
        tbLinhKien.setModel(model);
    }

    public void LoadDataConTrolLK(int vitri) {
        txtMaLK.setText(listLK.get(vitri).getMaLK());
        txtSoLuongLK.setText(String.valueOf(listLK.get(vitri).getSoLuongLK()));
        txtNgayNhapLK.setText(String.valueOf(listLK.get(vitri).getNgayNhapLK()));
        lbAnhLK.setIcon(new ImageIcon(String.valueOf(listLK.get(vitri).getAnhLK())));
        txtGiaLK.setText(listLK.get(vitri).getGiaLK());
        txtTenLK.setText(String.valueOf(listLK.get(vitri).getTenLK()));

    }

    public void timLK() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);
            PreparedStatement ps = con.prepareStatement("SELECT MaLK, SoLuong, NgayNhap, TenLK, Anh,Gia FROM LinhKien WHERE MaLK = ?");
            // truyền tham số
            ps.setString(1, txtMaLK.getText()); // Giả sử txtMaLK là một JTextField hoặc thành phần tương tự
            ResultSet rs = ps.executeQuery();

            // clear danh sách list 
            listLK.clear();
            while (rs.next()) {
                // tạo đối tượng QlLinhkien
                QlLinhkien LK = new QlLinhkien();
                LK.setMaLK(rs.getString("MaLK"));
                LK.setSoLuongLK(rs.getInt("SoLuong"));
                LK.setNgayNhapLK(rs.getString("NgayNhap"));
                LK.setAnhLK(rs.getString("Anh"));
                LK.setGiaLK(rs.getString("Gia"));
                LK.setTenLK(rs.getString("TenLK"));

                listLK.add(LK);
            }
            // Sau khi thêm vào listLK, gọi phương thức để cập nhật dữ liệu lên bảng
            dulieulenbangLK();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void themLK() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);
            PreparedStatement ps = con.prepareStatement("insert into LinhKien values(?,?,?,?,?,?)");
            ps.setString(1, txtMaLK.getText());
            ps.setString(2, (txtSoLuongLK.getText()));
            ps.setString(3, (txtNgayNhapLK.getText()));

            ps.setString(4, (lbAnhLK.getText()));
            ps.setString(5, (txtGiaLK.getText()));
            ps.setString(6, (txtTenLK.getText()));

            // thi hành
            int kq = ps.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Thêm Thành Công");
            }

            // đóng kết nối lại
            DulieuArrayLK();
            dulieulenbangLK();
            ps.close();
            con.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void capnhatLK() {

        if (txtMaLK.getText().equals("")) {
            JOptionPane.showMessageDialog(this, "Nhập mã SV");
            txtMaLK.requestFocus();
            return;
        }
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);
            String sql = "update LinhKien set SoLuong = ?, NgayNhap = ?, TenLK = ?, Anh = ?,Gia=? where MaLK = ?";
            PreparedStatement st = con.prepareStatement(sql);
//            st.setString(1, txtmasv.getText());
            st.setString(1, txtSoLuongLK.getText());
            st.setString(2, txtNgayNhapLK.getText());
            st.setString(3, txtTenLK.getText());

            st.setString(4, lbAnhLK.getText());
            st.setString(5, txtGiaLK.getText());
            st.setString(6, txtMaLK.getText());
            int kq = st.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Update Thành công");
            }
            DulieuArrayLK();
            dulieulenbangLK();
            st.close();
            con.close();
        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, "Update thất bại");
        }
    }

    public void xoaLK() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection connect = null;
            connect = DriverManager.getConnection(url, user, pass);
            String sql = "delete from LinhKien where MaLK = ?";
            PreparedStatement st = connect.prepareStatement(sql);
            st.setString(1, txtMaLK.getText());

            //thi hành
            int kq = st.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Xóa thành công");
            }
            DulieuArrayLK();
            dulieulenbangLK();
            st.close();
            connect.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void anhLK() {
        try {
            JFileChooser jfc = new JFileChooser("D:\\nhạpmonkithuatphanmem\\anhxe");

            jfc.showOpenDialog(null);
            File file = jfc.getSelectedFile();
            Image img = ImageIO.read(file);
            lbAnhLK.setText("");
            int W = lbAnhLK.getWidth();
            int h = lbAnhLK.getHeight();
            lbAnhLK.setIcon(new ImageIcon(img.getScaledInstance(W, h, 0)));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

// // Nhân viên 
// 
    void DulieuArrayNV() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);

            Statement st = cone.createStatement();
            String sql = "Select * from NhanVien";
            ResultSet rs = (ResultSet) st.executeQuery(sql);
            listNV.clear();
            while (rs.next()) {
                String maNV = rs.getString("MaNV");
                String TenNV = rs.getString("TenNv");
                String EmailNV = rs.getString("Email");

                String DiaChi = rs.getString("DiaChi");
                Boolean GioiTInhNV = rs.getBoolean("GioiTinh");
                String SoDTNV = rs.getString("SoDT");
                Boolean ChucVuNV = rs.getBoolean("Chucvu");
                String NamSinhNV = rs.getString("NamSinh");

                QlNhanVien NV = new QlNhanVien(maNV, TenNV, EmailNV, DiaChi, GioiTInhNV, SoDTNV, ChucVuNV, NamSinhNV);
                listNV.add(NV);
            }
            cone.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void dulieulenbangNV() {
        DefaultTableModel model = (DefaultTableModel) tbNhanVien.getModel();
        model.setRowCount(0);
        for (QlNhanVien sv : listNV) {
            Object row[] = new Object[]{sv.getMaNV(), sv.getTenNv(), sv.getEmail(), sv.getDiaChi(), sv.getGioiTinh(), sv.getSoDT(), sv.getChucvu(), sv.getNamSinh()};
            model.addRow(row);
        }
        tbNhanVien.setModel(model);
    }

    public void moiNV() {
        txtMaNV.setText("");
        txtTenNV.setText("");
        txtEmailNV.setText("");
        txtDiaChiNV.setText("");
        txtSoDTNV.setText("");
        txtNamSInhNV.setText("");
    }

    public void ThemNV() {
        if (txtMaNV.getText().equals("")) {
            JOptionPane.showMessageDialog(this, "nhập ma sinh viên");
//            txtMaNV.requestFocus();
            return;
        }
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);
            String sql = "insert into NhanVien values(?,?,?,?,?,?,?,?)";
            PreparedStatement st = cone.prepareStatement(sql);
            st.setString(1, txtMaNV.getText());
            st.setString(2, txtTenNV.getText());
            st.setString(3, txtEmailNV.getText());
            st.setString(4, txtDiaChiNV.getText());
            boolean gt;
            if (rdoNamNV.isSelected()) {
                gt = true;
            } else {
                gt = false;
            }
            st.setBoolean(5, gt);
            st.setString(6, txtSoDTNV.getText());
            boolean CV;
            if (rdoTruongPhongNV.isSelected()) {
                CV = true;
            } else {
                CV = false;
            }
            st.setBoolean(7, CV);
            st.setString(8, txtNamSInhNV.getText());

//            st.setString(8, txtChucVu.getText());
            st.executeUpdate();
            JOptionPane.showMessageDialog(this, "Seve thanh cong");
            DulieuArrayNV();
            dulieulenbangNV();
            cone.close();
//            loadDatatoAray();

        } catch (Exception e) {
//            System.out.println(e);
//            JOptionPane.showMessageDialog(this, "error");
            e.printStackTrace();
        }
    }

    public void xoaNV() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection connect = null;
            connect = DriverManager.getConnection(url, user, pass);
            String sql = "delete from NhanVien where MaNV = ?";
            PreparedStatement st = connect.prepareStatement(sql);
            st.setString(1, txtMaNV.getText());

            //thi hành
            int kq = st.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Xóa thành công");
            }
            DulieuArrayNV();
            dulieulenbangNV();
            st.close();
            connect.close();

        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    void timNV() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);
            PreparedStatement ps = con.prepareStatement("select NhanVien.MaNV,TenNv,Email,DiaChi,Email,DiaChi,GioiTinh,SoDT,Chucvu,NamSinh from NhanVien where NhanVien.MaNV = ? ");
            // truyền tham số
            ps.setString(1, txtMaNV.getText());
            ResultSet rs = ps.executeQuery();
            listNV.clear();
            while (rs.next()) {
                // tạo đối tượng BangDiem
                QlNhanVien gra = new QlNhanVien();
                gra.setMaNV(rs.getString("MaNV"));
                gra.setTenNv(rs.getString("TenNv"));
                gra.setEmail(rs.getString("Email"));
                gra.setDiaChi(rs.getString("DiaChi"));
                gra.setGioiTinh(rs.getBoolean("GioiTinh"));
                gra.setSoDT(rs.getString("SoDT"));
                gra.setChucvu(rs.getBoolean("Chucvu"));
//                gra.setEmail(rs.getString("Email"));
                gra.setNamSinh(rs.getString("NamSinh"));
//                gra.setGioiTinh(rs.("GioiTinh"));

                listNV.add(gra);
            }
//                    DulieuArrayNV();
            dulieulenbangNV();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    // thống kê 
// void DulieuArrayTK(){
//    try {
//        Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
//        Connection cone = null;
//        cone= DriverManager.getConnection(url, user, pass);
//        
//        Statement st =  cone.createStatement();
//                String sql ="Select * from SanPhamDaBan";
//                ResultSet rs  =(ResultSet) st.executeQuery(sql);
//                listTK.clear();
//                while(rs.next()){
//                    String TenSP = rs.getString("TenXe");
//                    String NgayNhapSP = rs.getString("NgayBan");
//                    Double GiaSPTK =(rs.getDouble("Gia"));
//                    String TenSPTK = rs.getString("SoLuong");
//                    
//                    QLThongKe LK = new QLThongKe(TenSP,NgayNhapSP,GiaSPTK,TenSPTK);
//                    listTK.add(LK);
//                }
//                cone.close();
//    } catch (Exception e) {
//        e.printStackTrace();
//    }
//}
    public void dulieulenbangTK() {
        DefaultTableModel model = (DefaultTableModel) tbThongKE.getModel();
        model.setRowCount(0);
        try {
            String keyword = txtTimKiemTK.getText();
            listTK = TKDAO.selectByKEYwor(keyword);
            for (QLThongKe TK : listTK) {
                Double tong = (TK.getGiaTK() * Double.valueOf(TK.getSoLuongTK()));
                Object[] obj = {
                    TK.getTenXeTK(),
                    TK.getNgayBanTK(),
                    moneyFormat.format(TK.getGiaTK()),
                    TK.getSoLuongTK(),
                    moneyFormat.format(tong)};
                model.addRow(obj);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

//tim kiếm 
//public void TimKiemTK(){
//    listKh.clear();
//    try {
//    Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
//    Connection con = DriverManager.getConnection(url, user, pass);
//    Statement st =  con.createStatement();
////    String sql ="SELECT SanPhamDaBan.TenXe,NgayBan,Gia,SoLuong From SanPhamDaBan "
////            + "Where TenXe like N'%"+txtTimKiemTK.getText()+"%' or NgayBan"+txtTimKiemTK.getText();
////            
//             String sql = "SELECT SanPhamDaBan.TenXe, NgayBan, Gia, SoLuong FROM SanPhamDaBan "
//             +"WHERE TenXe LIKE N'%" + txtTimKiemTK.getText() + "%' OR NgayBan = '" + txtTimKiemTK.getText() + "'";
//                
//            
//                ResultSet rs  =(ResultSet) st.executeQuery(sql);
//                listTK.clear();
//                while(rs.next()){
//                    String TenSP = rs.getString("TenXe");
//                    String NgayNhapSP = rs.getString("NgayBan");
//                    Double GiaSPTK = rs.getDouble("Gia");
//                    String TenSPTK = rs.getString("SoLuong");
//                    QLThongKe LK = new QLThongKe(TenSP,NgayNhapSP,GiaSPTK,TenSPTK);
//                    listTK.add(LK);
//                }
//                dulieulenbangTK();
//                con.close();
//    } catch (Exception e) {
//        e.printStackTrace();
//    }
////    String sql ="SELECT NgayBan, SUM(Gia * SoLuong) FROM SanPhamDaBan GROUP BY NgayBan";
//}
// test thống kê
    void DulieuArrayHD() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection cone = null;
            cone = DriverManager.getConnection(url, user, pass);

            Statement st = cone.createStatement();
            String sql = "Select * from HoaDon";
            ResultSet rs = (ResultSet) st.executeQuery(sql);
            listHD.clear();
            while (rs.next()) {
                String MaHD = rs.getString("MaHD");
                String NgayMuaHD = rs.getString("NgayMua");
                String GhiChuHD = rs.getString("GhiChu");
                String MaNVHD = rs.getString("MaNV");
                String MaKHHD = rs.getString("MaKH");
                String SanPhamHD = rs.getString("SanPham");
                String SoTienHD = rs.getString("Sotien");
                QLHoaDon LK = new QLHoaDon(MaHD, NgayMuaHD, GhiChuHD, MaNVHD, MaKHHD, SanPhamHD, SoTienHD);
                listHD.add(LK);
            }
            cone.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
//
    public void dulieulenbangHD() {
        DefaultTableModel model = (DefaultTableModel) tbhoaDon.getModel();
        model.setRowCount(0);
        List<QLHoaDon> listHD = hdDAO.selectAll();
        for (QLHoaDon hd : listHD) {

            model.addRow(new Object[]{
                hd.getMaHD(),
                hd.getNgayMua(),
                hd.getGhiChu(),
                hd.getMaNV(),
                hd.getMaKH(),
                hd.getSanPham(),
                hd.getSoTien()
            });
        } 
    }

// caau lenh in hoa don 
    public void InHoaDon() {
//        try {
//            XSSFWorkbook workbook = new XSSFWorkbook();
//            XSSFSheet sheet = workbook.createSheet("Danhsach");
//            XSSFRow row = null;
//            Cell cell = null;
//            row = sheet.createRow(3);
//
//            cell = row.createCell(0, CellType.STRING);
//            cell.setCellValue("STT");
//
//            cell = row.createCell(1, CellType.STRING);
//            cell.setCellValue("MaHD");
//
//            cell = row.createCell(2, CellType.STRING);
//            cell.setCellValue("Ngày mua");
//
//            cell = row.createCell(3, CellType.STRING);
//            cell.setCellValue("Ghi chú");
//
//            cell = row.createCell(4, CellType.STRING);
//            cell.setCellValue("MaNV");
//
//            cell = row.createCell(5, CellType.STRING);
//            cell.setCellValue("MaKH");
//
//            cell = row.createCell(6, CellType.STRING);
//            cell.setCellValue("Sản phẩm");
//
//            cell = row.createCell(7, CellType.STRING);
//            cell.setCellValue("Số tiền");
//
//            for (int i = 0; i < listHD.size(); i++) {
//                QLHoaDon hd = listHD.get(i);
//                row = sheet.createRow(4 + i);
//                cell = row.createCell(0, CellType.NUMERIC);
//                cell.setCellValue(i + 1);
//
//                cell = row.createCell(1, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getMaHD());
//
//                cell = row.createCell(2, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getNgayMuaHD());
//
//                cell = row.createCell(3, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getGhiChuHD());
//
//                cell = row.createCell(4, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getMaNVHD());
//
//                cell = row.createCell(5, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getMaKHHD());
//
//                cell = row.createCell(6, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getSanPhamHD());
//
//                cell = row.createCell(7, CellType.STRING);
//                cell.setCellValue(listHD.get(i).getSotienHD());
//
//                File f = new File("D:\\duan1\\HoaDon.xlsx");
//                System.out.println("Xuất file thành công");
//
//                try {
//                    FileOutputStream fis = new FileOutputStream(f);
//                    workbook.write(fis);
//                    fis.close();
//                } catch (Exception e) {
//                    e.printStackTrace();
//                }
//
//            }
//
//        } catch (Exception e) {
//            e.printStackTrace();
//        }

// ver 2
        try {
            File file = new File("data/HoaDon_" + txtMaHD.getText() + ".xlsx");
//            FileOutputStream fos = new FileOutputStream(file);
            PrintReport.printExcel(tbhoaDon, file);

        } catch (Exception e) {
        }

    }
    
    // in hoá đơn chuẩn 
    
    public void inhoadonmoi(){
        try {
            Document document = new Document();
            PdfWriter.getInstance(document, new FileOutputStream("moinhathoad/HoaDon.pdf"));
            document.open();
             BaseFont bf = BaseFont.createFont("c:\\windows\\fonts\\arial.ttf", BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
            Font font = new Font(bf, 12);
            Font fontBold = new Font(bf, 14, Font.BOLD);
            Font fontTitle = new Font(bf, 30, Font.BOLD);
            Paragraph p = new Paragraph("HÓA ĐƠN BÁn HÀNG", fontBold);
            document.add(p);
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
////            document.add(p);
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            p = new Paragraph("Cửa hàng: Showrrom  XE OTO LONG PHÁT",font);
            document.add(p);
            p = new Paragraph("Mã phiếu nhập: "+txtMaHD.getText(),font);// + txtMaHD, font);
            document.add(p);
//            p = new Paragraph("Ngày nhập: " + Xdate.toString(txtNgayMuaHD, "dd/MM/yyyy HH:mm:ss"), font);
//            document.add(p);
            p = new Paragraph("Nhân viên: " + txtMaNVHD.getText(), font);
            document.add(p);
// //           p = new Paragraph("Nhà cung cấp: " + nhaCungCap, font);
////            document.add(p);
//            document.add(new Paragraph(" "));
//            document.add(new Paragraph(" "));

            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            PdfPTable t = new PdfPTable(tbhoaDon.getColumnCount());
            float[] columnWidths = new float[tbhoaDon.getColumnCount()];
            for (int i = 0; i < tbhoaDon.getColumnCount(); i++) {
                t.addCell(new Phrase(tbhoaDon.getColumnName(i), fontBold));
                columnWidths[i] = 100f;
            }
            
            t.setWidthPercentage(columnWidths, document.getPageSize());
            for (int i = 0; i < tbhoaDon.getRowCount(); i++) {
                for (int j = 0; j < tbhoaDon.getColumnCount(); j++) {
                    t.addCell(new Phrase(tbhoaDon.getValueAt(i, j).toString(), font));
                }
            }
        
            
            // tổng tiền chưa đc 
            document.add(t);
//            p = new Paragraph("Tổng tiền: " + MoneyFormat.format(tongTien), font);
//            p.setAlignment(Element.ALIGN_RIGHT);
//            document.add(p);
            document.close();
        
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void themHD() {
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);
            PreparedStatement ps = con.prepareStatement("insert into HoaDon values(?,?,?,?,?,?,?)");
            ps.setString(1, txtMaHD.getText());
            ps.setString(2, (txtNgayMuaHD.getText()));
            ps.setString(3, (txtGhichuHD.getText()));

            ps.setString(4, (txtMaNVHD.getText()));
            ps.setString(5, (txtMakHHD.getText()));
            ps.setString(6, (txtSanPhamHD.getText()));
            ps.setString(7, (txtSoTienHD.getText()));

            // thi hành
            int kq = ps.executeUpdate();
            if (kq == 1) {
                JOptionPane.showMessageDialog(this, "Thêm Thành Công");
            }

            // đóng kết nối lại
            DulieuArrayHD();
            dulieulenbangHD();
            ps.close();
            con.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

//public void timkiemNV(){
// 
//    listNV.clear();
//    try {
//    Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
//    Connection con = DriverManager.getConnection(url, user, pass);
//    Statement st =  con.createStatement();
////    String sql ="SELECT SanPhamDaBan.TenXe,NgayBan,Gia,SoLuong From SanPhamDaBan "
////            + "Where TenXe like N'%"+txtTimKiemTK.getText()+"%' or NgayBan"+txtTimKiemTK.getText();
////            
//             String sql = "SELECT NhanVien.MaNV, TenNv, Email, DiaChi, GioiTinh,SoDT,Chucvu,NamSinh FROM NhanVien "
//             +"WHERE MaNV LIKE N'%" + txtMaNV.getText() + "%' OR TenNv = '" + txtTenNV.getText() + "' OR SoDT = '"+ txtSoDTNV.getText()+ "'";
//                
//             // test 
//             
//             
//             
//            
//                ResultSet rs  =(ResultSet) st.executeQuery(sql);
//                listNV.clear();
//                while(rs.next()){
//                    String MaNV = rs.getString("MaNV");
//                    String TenNV = rs.getString("TenNv");
//                    String EmailNV = rs.getString("Email");
//                    String DiaChiNV = rs.getString("DiaChi");
//                    Boolean GioiTinhNV = rs.getBoolean("GioiTinh");
//                    String SoDTNV = rs.getString("SoDT");
//                    Boolean ChucVUNV = rs.getBoolean("Chucvu");
//                    String NamSinhNV = rs.getString("NamSinh");
//                    QlNhanVien LK = new QlNhanVien(MaNV,TenNV,EmailNV,DiaChiNV,GioiTinhNV,SoDTNV,ChucVUNV,NamSinhNV);
//                    listNV.add(LK);
//                }
//                dulieulenbangNV();
//                con.close();
//    } catch (Exception e) {
//        e.printStackTrace();
//    }
//}
// 
//test 
//public void timkiemNVhh() {
//    listNV.clear();
//    try {
//        Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
//        Connection con = DriverManager.getConnection(url, user, pass);
//        
//        // Sử dụng PreparedStatement thay vì Statement
//        String sql = "SELECT MaNV, TenNv, Email, DiaChi, GioiTinh, SoDT, Chucvu, NamSinh FROM NhanVien "
//                   + "WHERE MaNV LIKE ? OR TenNv LIKE ? OR SoDT LIKE ?";
//        PreparedStatement ps = con.prepareStatement(sql);
//        ps.setString(1, "%" + txtMaNV.getText() + "%");
//        ps.setString(2, "N'%" + txtTenNV.getText() + "%");
//        ps.setString(3, "%" + txtSoDTNV.getText() + "%");
//        
//        ResultSet rs = ps.executeQuery();
//        
//        while (rs.next()) {
//            String MaNV = rs.getString("MaNV");
//            String TenNV = rs.getString("TenNv");
//            String EmailNV = rs.getString("Email");
//            String DiaChiNV = rs.getString("DiaChi");
//            Boolean GioiTinhNV = rs.getBoolean("GioiTinh");
//            String SoDTNV = rs.getString("SoDT");
//            Boolean ChucVUNV = rs.getBoolean("Chucvu");
//            String NamSinhNV = rs.getString("NamSinh");
//            
//            QlNhanVien LK = new QlNhanVien(MaNV, TenNV, EmailNV, DiaChiNV, GioiTinhNV, SoDTNV, ChucVUNV, NamSinhNV);
//            listNV.add(LK);
//        }
//        
//        dulieulenbangNV();
//        con.close();
//    } catch (Exception e) {
//        e.printStackTrace();
//    }
//}
// lỏ 
    public void timkiemNVlo() {
        listNV.clear();
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection con = DriverManager.getConnection(url, user, pass);

            // Sử dụng PreparedStatement thay vì Statement
            String sql = "SELECT MaNV, TenNv, Email, DiaChi, GioiTinh, SoDT, Chucvu, NamSinh FROM NhanVien "
                    + "WHERE MaNV LIKE ? OR TenNv LIKE ? OR SoDT LIKE ?";
            PreparedStatement ps = con.prepareStatement(sql);
            ps.setString(1, "%" + txtTimKiem.getText() + "%");
            ps.setString(2, "%" + txtTimKiem.getText() + "%");
            ps.setString(3, "%" + txtTimKiem.getText() + "%");

            ResultSet rs = ps.executeQuery();

            while (rs.next()) {
                String MaNV = rs.getString("MaNV");
                String TenNV = rs.getString("TenNv");
                String EmailNV = rs.getString("Email");
                String DiaChiNV = rs.getString("DiaChi");
                Boolean GioiTinhNV = rs.getBoolean("GioiTinh");
                String SoDTNV = rs.getString("SoDT");
                Boolean ChucVUNV = rs.getBoolean("Chucvu");
                String NamSinhNV = rs.getString("NamSinh");

                QlNhanVien LK = new QlNhanVien(MaNV, TenNV, EmailNV, DiaChiNV, GioiTinhNV, SoDTNV, ChucVUNV, NamSinhNV);
                listNV.add(LK);
            }

            dulieulenbangNV();
            con.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

//    public void fillTbSP() {
//        DefaultTableModel model = (DefaultTableModel) tblSanPhamGH.getModel();
//        model.setColumnIdentifiers(new String[]{
//            "MaSP", "TenSP", "Gia", "SoLuong"
//        });
//        model.setRowCount(0);
//        String key = txtTimKiemSP.getText();
//
//        List<QlSanPham> listSP = spDAO.selectByKEYwor(key);
//        for (QlSanPham sp : listSP) {
//            model.addRow(new Object[]{
//                sp.getMaSP(),
//                sp.getTenXe(),
//                moneyFormat.format(sp.getGia()),
//                sp.getSoLuong()
//
//            });
//        }
//
//    }

}
